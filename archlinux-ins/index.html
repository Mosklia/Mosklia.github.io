<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ArchLinux/Windows 双系统安装记录 | 一只萨科塔的博客</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><header><nav><a href="/">Home</a><a href="/archives/">Archives</a><a href="/about/">About</a><a href="/archives/#Tags">Tags</a><a href="/archives/#Categories">Categories</a></nav></header><main><article><div id="post-bg"><div id="post-title"><h1>ArchLinux/Windows 双系统安装记录</h1><hr></div><div id="post-content"><p>离我第一次入坑 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Main_page_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchLinux</a> 已有将近三年之久，期间我已经重装 Arch 不下十次了，但是却一直没有记录自己是怎么装的。正好，这次我的笔记本拿去维修了，维修点表示需要重装系统，这意味着本子拿回来之后，我得重装我的 Arch，我也借此机会，记录一下自己 Arch 的重装过程。</p>
<span id="more"></span>

<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p><strong>特别提醒</strong>：对于双系统玩家，强烈建议先安装 Windows，再去安装 Linux。</p>
<p>需要准备以下材料：</p>
<ul>
<li>一台电脑（废话）；</li>
<li>网络连接（本文采用无线网络）；</li>
<li>ArchLinux 启动盘一枚（我用的是 USB 启动介质）；<ul>
<li>听到 @dingyx99 大佬介绍了一个东西叫做 <a target="_blank" rel="noopener" href="https://www.ventoy.net/cn/index.html">Ventory</a>，可以不需要另外弄启动盘，直接在电脑划出一个分区就行了，后面试试。</li>
</ul>
</li>
<li>一台具有网络浏览器的设备，方便在安装的时候查看 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/">ArchWiki</a>上的<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">攻略</a>；<ul>
<li>非必需，玩得转的童鞋也可以考虑按照攻略上的说法，使用安装环境的<a target="_blank" rel="noopener" href="https://lynx.invisible-island.net/lynx_help/Lynx_users_guide.html">Lynx</a>来浏览攻略。</li>
</ul>
</li>
</ul>
<p>同时（双系统玩家）不要忘记在 Windows 下用系统自带的“磁盘管理”工具提前为 Linux 准备好一块空白分区（不要格式化）。</p>
<h1 id="安装基本系统"><a href="#安装基本系统" class="headerlink" title="安装基本系统"></a>安装基本系统</h1><p>这一部分的内容，基本按照 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/">ArchWiki</a>上的<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">攻略</a> 来做即可。</p>
<h2 id="进入-Live-环境"><a href="#进入-Live-环境" class="headerlink" title="进入 Live 环境"></a>进入 Live 环境</h2><p>插入安装介质，并在电脑<strong>刚刚按下开机键</strong>的时候设法进入启动菜单，选中你的安装介质，按回车。<br>例如：我的笔记本是 ROG 的幻 14，安装介质是一枚金士顿的 U 盘，我就在开机键按下之后，屏幕刚刚开始显示败家眼的图标时按下 Esc 键（这个键对于不同设备可能不一样）进入启动菜单。<br>注意：对于 Windows 10/11 用户，如果电脑屏幕下半部分出现了几个圆点转圈圈，那么恭喜你，等着 Windows 开机然后重启吧（悲</p>
<p>进入安装介质以后，会提示选择引导加载程序，直接默认（第一个）选项 <code>Arch Linux install medium</code> 回车就好。如果屏幕闪过大量文字后，清屏，显示一些 <code>Arch Linux...</code> 开头，<code>root@archiso ~ #</code> 结尾且后面有一个光标闪烁，恭喜你成功启动到 Live 环境。</p>
<h2 id="检查引导模式"><a href="#检查引导模式" class="headerlink" title="检查引导模式"></a>检查引导模式</h2><p>输入以下内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ls /sys/firmware/efi/efivars<br></code></pre></td></tr></table></figure>

<p>如果命令正常输出了目录下的东西（可能会很多，占满整个屏幕），那么你的系统就是以 UEFI 模式引导的。否则，如果输出诸如 <code>No such file or directory</code> 之类的错误信息，你的系统可能是以 BIOS 等其他模式引导的。<br>我的电脑下这个命令正常输出，因此判定我的系统以 UEFI 模式引导。下文的所有步骤，均基于这个结果来操作。</p>
<h2 id="连接到互联网"><a href="#连接到互联网" class="headerlink" title="连接到互联网"></a>连接到互联网</h2><p>幻 14 似乎没有网线接口，因此这里直接用无线网络~<br>使用 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Iwd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">iwd</a> 来连接到网络。输入 <code>iwctl</code>，如果屏幕显示 <code>[iwd]#</code> 则正常进入 iwd 的交互界面。输入 <code>device list</code>，即可查看所有可用的网络设备。我这里显示只有一个无线网卡 <code>wlan0</code>。下文中，将使用 <code>&lt;device&gt;</code>表示在这一步中你选用的无线设备。<br>输入 <code>station &lt;device&gt; scan</code> 以使设备扫描可用的网络，输入 <code>station &lt;device&gt; get-networks</code> 来获取周围可用的 WiFi 的名称。选取你所希望使用的那个 WiFi，其名称记为 <code>&lt;SSID&gt;</code>，输入 <code>station &lt;device&gt; connect &lt;SSID&gt;</code>，并输入密码（如果有），即可连接到 WiFi，然后按 Ctrl-D 退出 iwd。<br>建议在退出 iwd 之后使用 <code>ping</code> 验证一下网络连接：输入 <code>ping &lt;URL&gt; -c 3</code>，其中 <code>&lt;URL&gt;</code> 是你可以正常访问的网络的网址（不要带上 <code>http://</code> 或是 <code>https://</code>），如果输出包含形如 <code>xx bytes from xxx: icmp_seq=xxx ttl=xxx time=xxx</code> 的内容，说明网络连接正常，可以进入下一步骤。</p>
<h2 id="更新系统时间"><a href="#更新系统时间" class="headerlink" title="更新系统时间"></a>更新系统时间</h2><p>输入 <code>timedatectl set-ntp true</code>，并按下回车。</p>
<h2 id="建立硬盘分区"><a href="#建立硬盘分区" class="headerlink" title="建立硬盘分区"></a>建立硬盘分区</h2><p>建议事先阅读<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%BB%BA%E7%AB%8B%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA">官方教程的相关内容</a>来了解大致信息。</p>
<p><strong>风险警告</strong>：此步骤的误操作，可能导致电脑无法进入系统或者 Windows 系统及数据丢失等严重后果，请仔细阅读官方教程，并查阅其他资料，确保你知道自己在做什么！</p>
<p>输入 <code>lsblk</code> 可以查看各个存储设备和硬盘分区的简要情况，输入 <code>fdisk -l</code> 可以查看更加详细的内容。通过输出内容中各个分区/设备的大小，应该可以大致判断各个存储设备及其分区和其名称的对应关系。忽略 <code>rom</code>，<code>loop</code> 或者 <code>airoot</code> 结尾的设备，在其中找到你给 Linux 预留的空白存储空间，找到它对应的设备（例如，我的叫做<code>/dev/nvme0n1</code>），记为 <code>&lt;disk&gt;</code>，并留意其中是否已经包含一个类型为 <code>EFI System</code> 的分区（似乎 Windows 一般会自动创建这个分区）。<br>输入 <code>fdisk &lt;disk&gt;</code>，输入 <code>n</code> 来利用预留的空白存储空间创建一个新的分区，Partition number 和 First sector 直接使用默认数值即可，Last sector 默认会用完剩下全部的可用空间（你也可以使用<code>+xK,M,G,T,P</code>来手动指定大小），然后会提示该分区的类型。如果不是 <code>Linux filesystem</code> 请输入 <code>t</code>，然后输入刚刚新建的分区的编号，最后输入<code>20</code>，将其类型改变为 <code>Linux filesystem</code>，输入 <code>w</code> 来保存刚刚的修改，并退出 fdisk。</p>
<h2 id="格式化并挂载分区"><a href="#格式化并挂载分区" class="headerlink" title="格式化并挂载分区"></a>格式化并挂载分区</h2><p><strong>风险警告</strong>：此步骤的误操作，可能导致电脑无法进入系统或者 Windows 系统及数据丢失等严重后果，请仔细阅读官方教程，并查阅其他资料，确保你知道自己在做什么！</p>
<p>找到刚刚用 fdisk 新建的分区（输入 <code>fdisk -l</code>，找到 <code>Linux filesystem</code> 类型的那个分区），其名字记为 <code>&lt;part&gt;</code>（我的电脑上，它是 <code>/dev/nvme0n1p7</code>），输入 <code>mkfs.ext4 &lt;part&gt;</code> 来格式化它。<br>然后输入 <code>mount &lt;part&gt; /mnt</code> 来挂载它，并找到上一节中提到的类型为 <code>EFI System</code> 的分区（记为 <code>&lt;efi-part&gt;</code>，在我的电脑上它是 <code>/dev/nvme0n1p1</code>），依次输入 <code>mkdir /mnt/boot</code> 和 <code>mount &lt;efi-part&gt; /mnt/boot</code>。</p>
<h2 id="安装系统到硬盘"><a href="#安装系统到硬盘" class="headerlink" title="安装系统到硬盘"></a>安装系统到硬盘</h2><h3 id="更换软件包管理器的下载源"><a href="#更换软件包管理器的下载源" class="headerlink" title="更换软件包管理器的下载源"></a>更换软件包管理器的下载源</h3><p>编辑文件 <code>/etc/pacman.d/mirrorlist</code>（新手推荐使用命令 <code>nano /etc/pacman.d/mirrorlist</code>），按照<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/archlinux/">TUNA 镜像站的说明</a>，将 <code>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch</code> 添加到刚刚的文件顶端（使用 nano 的话，直接把这段代码输入进去，然后按一下回车，Ctrl-O 保存，Ctrl-X 退出）。</p>
<h3 id="安装系统及软件到硬盘"><a href="#安装系统及软件到硬盘" class="headerlink" title="安装系统及软件到硬盘"></a>安装系统及软件到硬盘</h3><p>输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pacstrap /mnt linux linux-firmware base iwd networkmanager nano grub efibootmgr os-prober ntfs-3g sudo<br></code></pre></td></tr></table></figure>

<p>然后耐心等待软件包安装完成。</p>
<h2 id="Fstab"><a href="#Fstab" class="headerlink" title="Fstab"></a>Fstab</h2><p>输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab<br></code></pre></td></tr></table></figure>

<p>然后再输入以下命令，查看生成文件是否正确：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">cat /mnt/etc/fstab<br></code></pre></td></tr></table></figure>

<h2 id="进入新系统"><a href="#进入新系统" class="headerlink" title="进入新系统"></a>进入新系统</h2><p>输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">arch-chroot /mnt<br></code></pre></td></tr></table></figure>

<h2 id="设置时区"><a href="#设置时区" class="headerlink" title="设置时区"></a>设置时区</h2><p>依次输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br>hwclock --systohc<br></code></pre></td></tr></table></figure>

<h2 id="本地化"><a href="#本地化" class="headerlink" title="本地化"></a>本地化</h2><p><strong>提示</strong>：本步骤将会影响以后系统能否使用中文、会不会乱码等与本地化相关的事情。</p>
<p>输入命令 <code>nano /etc/locale.gen</code>，然后搜索，并去掉以下内容前的<code>#</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">en_US.UTF-8<br>en_SG.UTF-8<br>zh_CN.UTF-8<br>zh_CN.GBK<br>zh_TW.UTF-8<br></code></pre></td></tr></table></figure>

<p><strong>提示</strong>：nano 中搜索的快捷键是 Ctrl-W。</p>
<p>然后按 Ctrl-O 保存，Ctrl-X 退出，输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">locale-gen<br><span class="hljs-built_in">echo</span> <span class="hljs-string">"LANG=en_SG.UTF-8"</span> &gt;&gt; /etc/locale.conf<br></code></pre></td></tr></table></figure>

<h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><p>选择一个你喜欢的主机名，记为<code>&lt;hostname&gt;</code>，然后执行命令：<code>echo &lt;hostname&gt; &gt;&gt; /etc/hostname</code>。<br>编辑 <code>/etc/hosts</code>（<code>nano /etc/hosts</code>），输入以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">127.0.0.1   localhost<br>::1         localhost<br>127.0.1.1   &lt;hostname&gt;<br></code></pre></td></tr></table></figure>

<p>按照官方教程的说法，我们需要在此时完成剩余的网络配置，包括安装软件和进行网络配置。而我们已经在<a href="#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%88%B0%E7%A1%AC%E7%9B%98">安装系统及软件到硬盘</a>这步完成了软件安装，且 NetworkManager 无法在此时完成配置，因此直接跳过，至下一步骤。</p>
<h2 id="修改-Root-密码"><a href="#修改-Root-密码" class="headerlink" title="修改 Root 密码"></a>修改 Root 密码</h2><p>默认的 Root 密码是随机生成的，在此我们需要手动更改，否则退出 Live 环境以后，我们将无法登录至 Root 账户（对于没有新建其他账户的电脑，这意味着无法进入系统）。<br>使用以下命令，按照提示修改 Root 密码（放心，不需要猜出原来的那个随机的密码）：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">passwd<br></code></pre></td></tr></table></figure>

<p><strong>警告</strong>：如果比尔知道电脑的 Root 密码，那么理论上他可以对这台电脑做任何事，因此请保证你的 Root 密码有一定强度（但不要让你自己都记不住：稍后我们还要用）。</p>
<h2 id="安装引导程序"><a href="#安装引导程序" class="headerlink" title="安装引导程序"></a>安装引导程序</h2><p><strong>警告</strong>：这个步骤至关重要，没能正确安装/配置引导程序可能导致 Linux，甚至可能是 Windows 系统无法启动。</p>
<p>我使用 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/GRUB_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">GRUB 2</a> 作为引导程序。它的依赖程序已经在<a href="#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%88%B0%E7%A1%AC%E7%9B%98">安装系统及软件到硬盘</a>中安装完成。执行以下命令来将 GRUB 安装到 EFI 分区：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB<br></code></pre></td></tr></table></figure>

<p>如果提示 <code>No error reported.</code> 则安装正常。</p>
<p>然后编辑文件 <code>/etc/default/grub</code> 并在文件结尾加上一行以下内容（来让 GRUB 探测 Windows 的存在）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">GRUB_DISABLE_OS_PROBER=false<br></code></pre></td></tr></table></figure>

<p>然后运行以下命令生成 GRUB 主配置文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grub-mkconfig -o /boot/grub/grub.cfg<br></code></pre></td></tr></table></figure>

<h2 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h2><p>按 Ctrl-D 退出新安装的系统，然后输入 <code>reboot</code>。不要忘记移除安装介质和在电脑启动的时候修改/选用正确的启动条目。<br>重启后，输入账户名：<code>root</code> 和刚刚修改的 Root 密码即可登录到新系统。</p>
<p>至此，一个基本的 ArchLinux 操作系统就安装完成了——除了没有网络连接，以及图形化界面的支持。这些问题，我们将稍后逐步解决。</p>
<h1 id="配置新系统"><a href="#配置新系统" class="headerlink" title="配置新系统"></a>配置新系统</h1><h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><p>日常直接使用 Root 账户是极其危险的一件事，因此我们需要创建普通用户来使用 ArchLinux。</p>
<h3 id="新建用户"><a href="#新建用户" class="headerlink" title="新建用户"></a>新建用户</h3><p>选择一个你喜欢的名字，记为<code>&lt;username&gt;</code>。<br>创建用户（并为其创建主文件夹）：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">useradd -m &lt;username&gt;<br></code></pre></td></tr></table></figure>

<p>然后修改其密码：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">passwd &lt;username&gt;<br></code></pre></td></tr></table></figure>

<h3 id="修改权限"><a href="#修改权限" class="headerlink" title="修改权限"></a>修改权限</h3><p>将用户加入群组 <code>wheel</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">usermod -aG wheel &lt;username&gt;<br></code></pre></td></tr></table></figure>

<p>然后允许该用户使用 <code>sudo</code>：首先运行命令<code>EDITOR=nano visudo</code>，然后找到行<code># %wheel ALL=(ALL) ALL</code>，去掉前面的 <code>#</code>，保存，退出 nano。</p>
<h2 id="连接到网络"><a href="#连接到网络" class="headerlink" title="连接到网络"></a>连接到网络</h2><p>使用 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/NetworkManager_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">NetworkManager</a>：首先启用相关的系统服务：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">systemctl start NetworkManager.service<br>systemctl <span class="hljs-built_in">enable</span> NetworkManager.service<br></code></pre></td></tr></table></figure>

<p>然后查找附近的 WiFi：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">nmcli device wifi list<br></code></pre></td></tr></table></figure>

<p>假设要连接的 WiFi 名称为 <code>&lt;SSID&gt;</code>，密码为 <code>&lt;password&gt;</code>，连接至 WiFi：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">nmcli device wifi connect &lt;SSID&gt; password &lt;password&gt;<br></code></pre></td></tr></table></figure>

<p>或者该 WiFi 没有密码：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">nmcli device wifi connect &lt;SSID&gt;<br></code></pre></td></tr></table></figure>

<p>最后，测试连接：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ping baidu.com -c 3<br></code></pre></td></tr></table></figure>

<h2 id="安装桌面环境"><a href="#安装桌面环境" class="headerlink" title="安装桌面环境"></a>安装桌面环境</h2><p>我选择的桌面环境为：Xorg + SDDM + KDE Plasma。</p>
<h3 id="安装显示驱动"><a href="#安装显示驱动" class="headerlink" title="安装显示驱动"></a>安装显示驱动</h3><p>先安装核显的驱动，保证能够正常进入桌面环境，然后再考虑独显的事情。<br>我的 CPU 是 AMD 的，因此核显驱动选择 <code>xf86-video-amdgpu</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pacman -S xf86-video-amdgpu<br></code></pre></td></tr></table></figure>

<h3 id="安装-Xorg"><a href="#安装-Xorg" class="headerlink" title="安装 Xorg"></a>安装 Xorg</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pacman -S xorg<br></code></pre></td></tr></table></figure>

<h3 id="安装-SDDM"><a href="#安装-SDDM" class="headerlink" title="安装 SDDM"></a>安装 SDDM</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pacman -S sddm sddm-kcm<br></code></pre></td></tr></table></figure>

<h3 id="安装-KDE-Plasma-及其配套软件"><a href="#安装-KDE-Plasma-及其配套软件" class="headerlink" title="安装 KDE Plasma 及其配套软件"></a>安装 KDE Plasma 及其配套软件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pacman -S plasma kde-applications<br></code></pre></td></tr></table></figure>

<p>然后自信重启。如果能够正常进入图形化的登陆界面，说明配置正常。</p>
<h3 id="中文化桌面环境"><a href="#中文化桌面环境" class="headerlink" title="中文化桌面环境"></a>中文化桌面环境</h3><p>直接在 KDE 自带的系统设置里面设置即可。重启生效。</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>注意记得将“点击文件或文件夹时”设置为“选中它们”，否则可能会导致文件操作不符合习惯。</p>
<p>从此以后的配置改用管理员账户（而非 Root 账户），因此某些命令可能需要加上 <code>sudo</code>。</p>
<h2 id="AUR-Helper"><a href="#AUR-Helper" class="headerlink" title="AUR Helper"></a>AUR Helper</h2><p>AUR 是 ArchLinux 的一大竞争力，很多优秀的软件都被放在 AUR 上。<br>我使用的 AUR Helper 是 pikaur。它不在官方的软件仓库里面。具体安装过程和配置可参考<a target="_blank" rel="noopener" href="https://github.com/actionless/pikaur">项目的 GitHub 页面</a>。<br>建议安装后额外运行一下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo pacman -S asp python-pysocks<br></code></pre></td></tr></table></figure>

<h2 id="中文输入法"><a href="#中文输入法" class="headerlink" title="中文输入法"></a>中文输入法</h2><p>采用的方案为 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Fcitx5</a> 下的中文输入插件。</p>
<p>输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo pacman -S fcitx5-im fcitx5-qt fcitx5-gtk fcitx5-chinese-addons fcitx5-configtool fcitx5-pinyin-zhwiki<br></code></pre></td></tr></table></figure>

<p>并将以下内容输入到文件 <code>~/.pam_environment</code> 中（如果没有，就新建一个）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">GTK_IM_MODULE DEFAULT=fcitx<br>QT_IM_MODULE  DEFAULT=fcitx<br>XMODIFIERS    DEFAULT=@im=fcitx<br>INPUT_METHOD  DEFAULT=fcitx<br>SDL_IM_MODULE DEFAULT=fcitx<br></code></pre></td></tr></table></figure>

<p>然后运行 fcitx5 配置，“添加输入法”里面找到拼音，点击“添加”。另外建议多看看其他按钮，看一下有些什么可以调教的。</p>
<p>如果重启电脑后发现输入法没有运行，“系统设置”-&gt;“开机与关机”-&gt;“添加”-&gt;“添加应用”，找到“Fcitx 5”，点确定。</p>
<h2 id="双显卡切换"><a href="#双显卡切换" class="headerlink" title="双显卡切换"></a>双显卡切换</h2><p>我的电脑是 AMD 的核显和 RTX 2060MQ 的独显，采用的是独显做大部分显示，仅需要时手动使用核显的思路。</p>
<p>采用的切换方案是 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/PRIME">PRIME</a>。</p>
<p>首先需要安装驱动，这里为了性能，使用 Nivida 的闭源驱动 <code>nvidia</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo pacman -S nvidia nvidia-prime<br></code></pre></td></tr></table></figure>

<p>另外可以考虑安装以下验证用的软件包 <code>mesa-demos</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo pacman -S mesa-demos<br></code></pre></td></tr></table></figure>

<p>重启电脑，现在输入这两个命令验证安装是否正确：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">glxinfo | grep <span class="hljs-string">"OpenGL render"</span> <span class="hljs-comment"># OpenGL renderer string: AMD RENOIR (DRM 3.41.0, 5.13.13-arch1-1, LLVM 12.0.1)</span><br>prime-run glxinfo | grep <span class="hljs-string">"OpenGL render"</span> <span class="hljs-comment"># OpenGL renderer string: NVIDIA GeForce RTX 2060 with Max-Q Design/PCIe/SSE2</span><br></code></pre></td></tr></table></figure>

<p>如果安装正确，以后启动应用时在其前面加上 <code>prime-run</code> 就可以切换到独显来渲染了。</p>
<div id="paginator"></div></div><div id="post-footer"><hr><a href="/hello-world/">Hello World Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: ''
 , appKey: ''
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><a href="/" id="logo"><img src="/imgs/base/avatar.jpg" alt="Logo"></a><h1 id="Dr"><a href="/"> Dr.Sparky</a></h1><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">2</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">3</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">1</span></div></section></div><div id="aside-block"><h1>INDEX</h1><div id="post-index"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%9F%BA%E6%9C%AC%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.</span> <span class="toc-text">安装基本系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E5%85%A5-Live-%E7%8E%AF%E5%A2%83"><span class="toc-number">2.1.</span> <span class="toc-text">进入 Live 环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BC%95%E5%AF%BC%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.2.</span> <span class="toc-text">检查引导模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%88%B0%E4%BA%92%E8%81%94%E7%BD%91"><span class="toc-number">2.3.</span> <span class="toc-text">连接到互联网</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4"><span class="toc-number">2.4.</span> <span class="toc-text">更新系统时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">2.5.</span> <span class="toc-text">建立硬盘分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B9%B6%E6%8C%82%E8%BD%BD%E5%88%86%E5%8C%BA"><span class="toc-number">2.6.</span> <span class="toc-text">格式化并挂载分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%88%B0%E7%A1%AC%E7%9B%98"><span class="toc-number">2.7.</span> <span class="toc-text">安装系统到硬盘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%8D%A2%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E7%9A%84%E4%B8%8B%E8%BD%BD%E6%BA%90"><span class="toc-number">2.7.1.</span> <span class="toc-text">更换软件包管理器的下载源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%88%B0%E7%A1%AC%E7%9B%98"><span class="toc-number">2.7.2.</span> <span class="toc-text">安装系统及软件到硬盘</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fstab"><span class="toc-number">2.8.</span> <span class="toc-text">Fstab</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E5%85%A5%E6%96%B0%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.9.</span> <span class="toc-text">进入新系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA"><span class="toc-number">2.10.</span> <span class="toc-text">设置时区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%8C%96"><span class="toc-number">2.11.</span> <span class="toc-text">本地化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">2.12.</span> <span class="toc-text">网络配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-Root-%E5%AF%86%E7%A0%81"><span class="toc-number">2.13.</span> <span class="toc-text">修改 Root 密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.14.</span> <span class="toc-text">安装引导程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%90%AF"><span class="toc-number">2.15.</span> <span class="toc-text">重启</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%B0%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.</span> <span class="toc-text">配置新系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7"><span class="toc-number">3.1.</span> <span class="toc-text">用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">3.1.1.</span> <span class="toc-text">新建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90"><span class="toc-number">3.1.2.</span> <span class="toc-text">修改权限</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%88%B0%E7%BD%91%E7%BB%9C"><span class="toc-number">3.2.</span> <span class="toc-text">连接到网络</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83"><span class="toc-number">3.3.</span> <span class="toc-text">安装桌面环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">安装显示驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Xorg"><span class="toc-number">3.3.2.</span> <span class="toc-text">安装 Xorg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-SDDM"><span class="toc-number">3.3.3.</span> <span class="toc-text">安装 SDDM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-KDE-Plasma-%E5%8F%8A%E5%85%B6%E9%85%8D%E5%A5%97%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.3.4.</span> <span class="toc-text">安装 KDE Plasma 及其配套软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E6%96%87%E5%8C%96%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83"><span class="toc-number">3.3.5.</span> <span class="toc-text">中文化桌面环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">3.3.6.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AUR-Helper"><span class="toc-number">3.4.</span> <span class="toc-text">AUR Helper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95"><span class="toc-number">3.5.</span> <span class="toc-text">中文输入法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E6%98%BE%E5%8D%A1%E5%88%87%E6%8D%A2"><span class="toc-number">3.6.</span> <span class="toc-text">双显卡切换</span></a></li></ol></li></ol></div></div><footer><wbr><nobr>published with&nbsp;<a target="_blank" rel="noopener" href="http://hexo.io">Hexo&nbsp;</a></nobr><wbr><nobr>Theme&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight&nbsp;</a></nobr><wbr><nobr>by&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script></body></html>